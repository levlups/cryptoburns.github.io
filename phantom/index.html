<html>
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
  <body>
    <script>
      async function fetchTokenBalances() {
        // Ensure Phantom is available in the window object
        if (!('phantom' in window)) {
          window.open('https://phantom.app/', '_blank');
          return;
        }

        const provider = window.phantom?.solana;

        // Try to connect to Phantom
        try {
          const resp = await provider.connect();
          const walletPublicKey = resp.publicKey;
          console.log('Wallet Public Key:', walletPublicKey.toString());

          // Set up connection to Solana devnet
          const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('devnet'));

          // Token Mint Address (replace with the actual mint address)
          const tokenMintAddress = new solanaWeb3.PublicKey('4sp2EUDrQf46rZun6sYAWzjrXwUpx2T3njuoKmV766RJ');

          // Fetch all token accounts for the wallet
          const tokenAccounts = await connection.getParsedTokenAccountsByOwner(walletPublicKey, {
            mint: tokenMintAddress,
          });

          if (tokenAccounts.value.length > 0) {
            // Log balances of all token accounts found
            tokenAccounts.value.forEach((account, index) => {
              const balance = account.account.data.parsed.info.tokenAmount.uiAmount;
              console.log(`Token Account ${index + 1} Balance:`, balance);
            });
          } else {
            console.log("No token accounts found.");
          }
        } catch (error) {
          console.error('Error fetching token balances:', error);
        }
      }

      fetchTokenBalances();
    </script>
  </body>
</html>
