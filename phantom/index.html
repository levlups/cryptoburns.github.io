<html>
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
  <body>
    <script>
      let connection;
      let tokenMintAddress;
      let mainaddress;
      async function fetchTokenBalances() {
        // Ensure Phantom is available in the window object
        if (!('phantom' in window)) {
          window.open('https://phantom.app/', '_blank');
          return;
        }

        const provider = window.phantom?.solana;

        // Try to connect to Phantom
        try {
          const resp = await provider.connect();
          const walletPublicKey = resp.publicKey;
          console.log('Wallet Public Key:', walletPublicKey.toString());

          // Set up connection to Solana devnet
           connection = new solanaWeb3.Connection("https://docs-demo.solana-mainnet.quiknode.pro/");

          mainaddress=new solanaWeb3.PublicKey(walletPublicKey.toString());

          // Token Mint Address (replace with the actual mint address)
          tokenMintAddress = new solanaWeb3.PublicKey('4sp2EUDrQf46rZun6sYAWzjrXwUpx2T3njuoKmV766RJ');

       } catch (err) {
    // { code: 4001, message: 'User rejected the request.' }
}
(async () => {
  const publicKey = new solanaWeb3.PublicKey(
    "3XZwt8wCPJ5UeGvvBJyj3hYE5pRzZ9wADgtb4PBCd6Uu"
  );
  const solana = new solanaWeb3.Connection("https://docs-demo.solana-mainnet.quiknode.pro/");
  console.log(await solana.getAccountInfo(publicKey));
  const info = await solana.getTokenAccountBalance( tokenMintAddress);
    if (info.value.uiAmount == null) throw new Error('No balance found');
    console.log('Balance (using Solana-Web3.js): ', info.value.uiAmount);
    return info.value.uiAmount;
})();

async function getTokenBalanceWeb3(connection, tokenAccount) {
    const info = await connection.getTokenAccountBalance( tokenMintAddress);
    if (info.value.uiAmount == null) throw new Error('No balance found');
    console.log('Balance (using Solana-Web3.js): ', info.value.uiAmount);
    return info.value.uiAmount;
}

getTokenBalanceWeb3(connection, tokenMintAddress).catch(err => console.log(err));

          

         
      }

      fetchTokenBalances();



async function getSPLTokenBalance(walletAddress, tokenMintAddress) {
    // Connect to the Solana mainnet
   // const connection = new web3.Connection(web3.clusterApiUrl('mainnet-beta'), 'confirmed');

    // Create a PublicKey object for the wallet and token mint addresses
    const walletPublicKey = new solanaWeb3.PublicKey(walletAddress);
    const tokenMintPublicKey = new solanaWeb3.PublicKey(tokenMintAddress);

    // Get the token account of the wallet for the specified token mint
    const tokenAccounts = await connection.getParsedTokenAccountsByOwner(walletPublicKey, { mint: tokenMintPublicKey });

    if (tokenAccounts.value.length > 0) {
        const accountInfo = tokenAccounts.value[0].account.data.parsed.info;
        const balance = accountInfo.tokenAmount.uiAmount;
        console.log(`Wallet SPL Token Balance: ${balance} ${accountInfo.tokenAmount.unit}`);
    } else {
        console.log("This wallet does not have the specified SPL token.");
    }
}



getSPLTokenBalance(mainaddress, tokenMintAddress);

      
    </script>
  </body>
</html>
