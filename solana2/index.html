<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paywall Check</title>
 
      <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
</head>
<body>
    <button id="payButton">Pay 0.1 SOL</button>

    <script>
        const network = 'https://docs-demo.solana-mainnet.quiknode.pro/'; // Replace with your QuickNode RPC URL
        const connection = new solanaWeb3.Connection(network);
        const publicKey = new solanaWeb3.PublicKey('3XZwt8wCPJ5UeGvvBJyj3hYE5pRzZ9wADgtb4PBCd6Uu'); // Your public key

        document.getElementById('payButton').addEventListener('click', async () => {
            const transaction = new solanaWeb3.Transaction();
            // Constructing a transaction to transfer 0.1 SOL
            const transferInstruction = solanaWeb3.SystemProgram.transfer({
                fromPubkey: payer.publicKey,
                toPubkey: receiverPublicKey, // Add the recipient's public key
                lamports: solanaWeb3.LAMPORTS_PER_SOL * 0.1 // Transferring 0.1 SOL
            });
            transaction.add(transferInstruction);

            try {
                // Assume wallet connection and transaction logic here
                const { signature } = await solanaWeb3.sendAndConfirmTransaction(connection, transaction, [payer]);
                const result = await connection.getSignatureStatus(signature);
                if (result && result.value.confirmationStatus === 'confirmed') {
                    sendPostRequest(signature);
                }
            } catch (error) {
                console.error('Transaction failed:', error);
            }
        });

        function sendPostRequest(transactionSignature) {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "https://your-php-site.com/receive_payment.php");
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.send(JSON.stringify({ signature: transactionSignature }));

            xhr.onload = function() {
                console.log("Response from server:", xhr.responseText);
            };
        }
    </script>
</body>
</html>
